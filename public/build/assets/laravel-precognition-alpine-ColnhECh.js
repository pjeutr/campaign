import{c as m,t as A,r as v,a as f,b as F,d as S}from"./laravel-precognition-3q_-3qwP.js";import{c as l,g as p,s as C}from"./lodash-es-BeZXkzNc.js";function P(r){r.magic("form",i=>(d,s,u,E={})=>{const h=l(u),g=Object.keys(h),c=r.reactive({touched:[],valid:[]}),o=m(t=>t[f(d)](v(s),e.data(),E),h).on("validatingChanged",()=>{e.validating=o.validating()}).on("validatedChanged",()=>{c.valid=o.valid()}).on("touchedChanged",()=>{c.touched=o.touched()}).on("errorsChanged",()=>{e.hasErrors=o.hasErrors(),e.errors=A(o.errors()),c.valid=o.valid()}),b=t=>({...t,precognitive:!1,onStart:()=>{e.processing=!0,(t.onStart??(()=>null))()},onFinish:()=>{e.processing=!1,(t.onFinish??(()=>null))()},onValidationError:(n,a)=>(o.setErrors(n.data.errors),t.onValidationError?t.onValidationError(n):Promise.reject(a))}),y=()=>({...l(u),data(){const t=l(e);return g.reduce((n,a)=>({...n,[a]:t[a]}),{})},touched(t){return c.touched.includes(t)},touch(t){return o.touch(t),e},validate(t,n){return typeof t=="object"&&!("target"in t)&&(n=t,t=void 0),typeof t>"u"?o.validate(n):(t=F(t),o.validate(t,p(e.data(),t),n)),e},validating:!1,valid(t){return c.valid.includes(t)},invalid(t){return typeof e.errors[t]<"u"},errors:{},hasErrors:!1,setErrors(t){return o.setErrors(t),e},forgetError(t){return o.forgetError(t),e},reset(...t){const n=l(h);return t.length===0?g.forEach(a=>e[a]=n[a]):t.forEach(a=>C(e,a,p(n,a))),o.reset(...t),e},setValidationTimeout(t){return o.setTimeout(t),e},processing:!1,async submit(t={}){return S[f(d)](v(s),e.data(),b(t))},validateFiles(){return o.validateFiles(),e}}),e=r.reactive(y());return V(r,i,f(d),v(s),e),e})}const V=(r,i,d,s,u)=>{i instanceof Element&&i.nodeName==="FORM"&&(M(i,d),j(i,d),x(i,s),T(r,i,u))},j=(r,i)=>{i!=="get"&&!r.hasAttribute("method")&&r.setAttribute("method","POST")},x=(r,i)=>{r.hasAttribute("action")||r.setAttribute("action",i)},M=(r,i)=>{if(["get","post"].includes(i)||r.querySelector('input[type="hidden"][name="_method"]')!==null)return;const s=r.insertAdjacentElement("afterbegin",document.createElement("input"));s!==null&&(s.setAttribute("type","hidden"),s.setAttribute("name","_method"),s.setAttribute("value",i.toUpperCase()))},T=(r,i,d)=>i.addEventListener("submit",()=>{r.nextTick(()=>d.processing=!0)});export{P as p};
